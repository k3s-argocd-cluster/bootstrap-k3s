### Generated by ansible :: demelopment.k3s.argocd@render_templates ###
apiVersion: v1
kind: ConfigMap
metadata:
  name: postgresql-initdb-config
  namespace: postgresql
data:

  00_user.sh: |
    #!/bin/bash
    set -e

    psql -v ON_ERROR_STOP=1 --username "$POSTGRES_USER" --dbname "$POSTGRES_DB" -v POSTGRES_iobroker_PASSWORD="$POSTGRES_iobroker_PASSWORD" <<-EOSQL
      CREATE ROLE iobroker CREATEDB LOGIN PASSWORD :'POSTGRES_iobroker_PASSWORD';
    EOSQL
  
  01_user.sh: |
    #!/bin/bash
    set -e

    psql -v ON_ERROR_STOP=1 --username "$POSTGRES_USER" --dbname "$POSTGRES_DB" -v POSTGRES_gitea_PASSWORD="$POSTGRES_gitea_PASSWORD" <<-EOSQL
      CREATE ROLE gitea LOGIN PASSWORD :'POSTGRES_gitea_PASSWORD';
    EOSQL
  
  02_database.sh: |
    #!/bin/bash
    set -e

    psql -v ON_ERROR_STOP=1 --username "$POSTGRES_USER" --dbname "$POSTGRES_DB" <<-EOSQL
      CREATE DATABASE iobroker OWNER iobroker;
    EOSQL
  
  03_database.sh: |
    #!/bin/bash
    set -e

    psql -v ON_ERROR_STOP=1 --username "$POSTGRES_USER" --dbname "$POSTGRES_DB" <<-EOSQL
      CREATE DATABASE gitea OWNER gitea;
    EOSQL
  
